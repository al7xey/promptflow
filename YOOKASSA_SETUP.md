# Настройка интеграции с ЮKassa

## Переменные окружения

Добавьте следующие переменные окружения в файл `.env.local` (для локальной разработки) или в настройках вашего хостинга (Vercel, Netlify и т.д.):

```env
YOOKASSA_SHOP_ID=ваш_shop_id
YOOKASSA_SECRET_KEY=ваш_секретный_ключ
NEXT_PUBLIC_BASE_URL=https://ваш-домен.com
```

## Получение учетных данных

1. Зарегистрируйтесь в [ЮKassa](https://yookassa.ru/)
2. Создайте магазин в личном кабинете
3. Получите `Shop ID` и `Secret Key` в настройках магазина
4. Для тестирования используйте тестовые ключи из раздела "Тестовые данные"

## Настройка return_url

В настройках магазина ЮKassa укажите `return_url`:
```
https://ваш-домен.com/payment?payment=success
```

Этот URL будет использоваться для возврата пользователя после успешной оплаты.

## Webhook (опционально, рекомендуется для продакшена)

Для более надежного подтверждения оплаты рекомендуется настроить webhook:

1. В настройках магазина ЮKassa укажите URL webhook:
   ```
   https://ваш-домен.com/api/payment-webhook
   ```

2. Создайте файл `app/api/payment-webhook/route.ts` для обработки уведомлений от ЮKassa

## Тестирование

Для тестирования используйте тестовые карты:
- Успешная оплата: `5555 5555 5555 4444`
- Отклоненная оплата: `5555 5555 5555 4477`

Срок действия и CVV можно указать любые будущие значения.

## Структура проекта

- `app/payment/page.tsx` - страница оплаты
- `app/api/create-payment/route.ts` - API endpoint для создания платежа
- `app/page.tsx` - главная страница с отслеживанием лимита бесплатных попыток

## Логика работы

1. Пользователь имеет 10 бесплатных улучшений промтов
2. После исчерпания лимита отображается предложение купить вечный доступ
3. При нажатии на кнопку покупки создается платеж через ЮKassa
4. После успешной оплаты пользователь перенаправляется обратно с параметром `payment=success`
5. Статус оплаты сохраняется в `localStorage` и счетчик бесплатных попыток сбрасывается
6. Пользователь получает неограниченный доступ к улучшению промтов

